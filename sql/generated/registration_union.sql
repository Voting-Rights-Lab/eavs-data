-- EAVS eavs_county_reg_union Union View
-- Automatically generated from config - all years included dynamically
-- DO NOT EDIT - regenerate using scripts/generate_dynamic_unions.py

CREATE OR REPLACE VIEW `eavs-392800.eavs_analytics.eavs_county_reg_union` AS

-- 2016 Data
SELECT 
  fips,
  '2016' as election_year,
  state,
  county,
  state_abbr,
  county_name,
  NULL as election_year,
  state as state,
  county as county,
  State_Abbr as state_abbr,
  county_name as county_name,
  A1a_REG_total as total_reg,
  A3a_REG_Active as total_active_reg,
  A3b_REG_Inactive as total_inactive_reg,
  A4a_REG_SDR_total as total_sdr,
  NULL as election_day_sdr,
  NULL as prior_election_day_sdr,
  A5a_REG_forms_total as total_reg_received,
  A5b_REG_forms_new_valid as total_valid_reg,
  A5c_REG_forms_new_prereg as pre_reg,
  A5e_REG_forms_rejected as invalid_reg,
  A6a_REG_forms_all_source_mail as mail_reg,
  A6b_REG_forms_all_source_inperson as in_person_reg,
  A6c_REG_forms_all_source_online as online_reg,
  A6d_REG_forms_all_source_DMV as dmv_reg,
  A6e_REG_forms_all_source__NVRA_agency as nvra_reg,
  A6f_REG_forms_all_source_disab_agency as disability_reg,
  A6g_REG_forms_all_source_armed_forces as armed_forces_reg,
  A6h_REG_forms_all_source_nonNVRA_agency as non_nvra_reg,
  A7a_REG_forms_new_source_mail as new_mail_reg,
  A7b_REG_forms_new_source_inperson as new_in_person_reg,
  A7c_REG_forms_new_source_online as new_online_reg,
  A7d_REG_forms_new_source_DMV as new_dmv_reg,
  A7e_REG_forms_new_source__NVRA_agency as new_nvra_reg,
  A7f_REG_forms_new_source_disab_agency as new_disability_reg,
  A7g_REG_forms_new_source_armed_forces as new_armed_forces_reg,
  A7h_REG_forms_new_source_nonNVRA_agency as new_non_nvra_reg,
  A10a_REG_notification_sent as confirmation_notices_sent,
  A10b_REG_notification_ret_confirm as confirmation_notices_received,
  A11a_REG_removed_total as total_voters_removed,
  A11b_REG_removed_moved as voters_removed_moved,
  A11c_REG_removed_death as voters_removed_death,
  A11d_REG_removed_felony as voters_removed_felony,
  A11e_REG_removed_fail_resp as voters_removed_fail_response,
  A11f_REG_removed_ment_inc as voters_removed_mentally_incompetent,
  A11g_REG_removed_voter_request as voters_removed_voter_request
FROM `eavs-392800.eavs_2016.eavs_county_16_A_REG`

UNION ALL

-- 2018 Data
SELECT 
  fips,
  '2018' as election_year,
  state,
  county,
  state_abbr,
  county_name,
  NULL as election_year,
  state as state,
  county as county,
  State_Abbr as state_abbr,
  county_name as county_name,
  a1a_total_reg as total_reg,
  a1b_total_active as total_active_reg,
  a1c_total_inactive as total_inactive_reg,
  a2a_total_new_sdr as total_sdr,
  NULL as election_day_sdr,
  NULL as prior_election_day_sdr,
  a3a_total_registered_forms as total_reg_received,
  a3b_new_valid as total_valid_reg,
  a3c_new_pre_reg as pre_reg,
  a3e_invalid as invalid_reg,
  a4a_mail_total as mail_reg,
  a4b_in_person_total as in_person_reg,
  a4c_online_total as online_reg,
  a4d_dmv_total as dmv_reg,
  a4e_nvra_mandated_total as nvra_reg,
  a4f_disabilities_agency_total as disability_reg,
  a4g_armed_forces_total as armed_forces_reg,
  a4h_non_nvra_mandated_total as non_nvra_reg,
  a5a_mail_new_reg as new_mail_reg,
  a5b_in_person_new_reg as new_in_person_reg,
  a5c_online_new_reg as new_online_reg,
  a5d_dmv_new_reg as new_dmv_reg,
  a5e_nvra_mandated_new_reg as new_nvra_reg,
  a5f_disabilities_agency_new_reg as new_disability_reg,
  a5g_armed_forces_new_reg as new_armed_forces_reg,
  a5h_non_nvra_mandated_new_reg as new_non_nvra_reg,
  a8a_notifications_total as confirmation_notices_sent,
  a8b_notifications_received_confirming as confirmation_notices_received,
  a9a_removed_total as total_voters_removed,
  a9b_removed_moved as voters_removed_moved,
  a9c_removed_death as voters_removed_death,
  a9d_removed_felony as voters_removed_felony,
  a9e_removed_fail_response as voters_removed_fail_response,
  a9f_removed_mentally_incompetent as voters_removed_mentally_incompetent,
  a9g_removed_voter_request as voters_removed_voter_request
FROM `eavs-392800.eavs_2018.eavs_county_18_A_REG`

UNION ALL

-- 2020 Data
SELECT 
  fips,
  '2020' as election_year,
  state,
  county,
  state_abbr,
  county_name,
  NULL as election_year,
  state as state,
  county as county,
  State_Abbr as state_abbr,
  county_name as county_name,
  A1a_REG_total as total_reg,
  A1b_REG_active as total_active_reg,
  A1c_REG_inactive as total_inactive_reg,
  A2a_REG_SDR_total as total_sdr,
  A2b_REG_SDR_ED as election_day_sdr,
  A2c_REG_SDR_early as prior_election_day_sdr,
  A3a_REG_forms_total as total_reg_received,
  A3b_REG_forms_new_valid as total_valid_reg,
  A3c_REG_forms_new_prereg as pre_reg,
  A3e_REG_forms_rejected as invalid_reg,
  A4a_REG_forms_all_source_mail as mail_reg,
  A4b_REG_forms_all_source_inperson as in_person_reg,
  A4c_REG_forms_all_source_online as online_reg,
  A4d_REG_forms_all_source_DMV as dmv_reg,
  A4e_REG_forms_all_source__NVRA_agency as nvra_reg,
  A4f_REG_forms_all_source_disab_agency as disability_reg,
  A4g_REG_forms_all_source_armed_forces as armed_forces_reg,
  A4h_REG_forms_all_source_nonNVRA_agency as non_nvra_reg,
  A5a_REG_forms_new_source_mail as new_mail_reg,
  A5b_REG_forms_new_source_inperson as new_in_person_reg,
  A5c_REG_forms_new_source_online as new_online_reg,
  A5d_REG_forms_new_source_DMV as new_dmv_reg,
  A5e_REG_forms_new_source__NVRA_agency as new_nvra_reg,
  A5f_REG_forms_new_source_disab_agency as new_disability_reg,
  A5g_REG_forms_new_source_armed_forces as new_armed_forces_reg,
  A5h_REG_forms_new_source_nonNVRA_agency as new_non_nvra_reg,
  A8a_REG_notification_sent as confirmation_notices_sent,
  A8b_REG_notification_ret_confirm as confirmation_notices_received,
  A9a_REG_removed_total as total_voters_removed,
  A9b_REG_removed_moved as voters_removed_moved,
  A9c_REG_removed_death as voters_removed_death,
  A9d_REG_removed_felony as voters_removed_felony,
  A9e_REG_removed_fail_resp as voters_removed_fail_response,
  A9f_REG_removed_ment_inc as voters_removed_mentally_incompetent,
  A9g_REG_removed_voter_request as voters_removed_voter_request
FROM `eavs-392800.eavs_2020.eavs_county_20_A_REG`

UNION ALL

-- 2022 Data
SELECT 
  fips,
  '2022' as election_year,
  state,
  county,
  state_abbr,
  county_name,
  NULL as election_year,
  state as state,
  county as county,
  state_name_abbreviation as state_abbr,
  county_name as county_name,
  a1a_total_reg as total_reg,
  a1b_total_active as total_active_reg,
  a1c_total_inactive as total_inactive_reg,
  a2a_total_sdr as total_sdr,
  a2b_election_day_sdr as election_day_sdr,
  a2c_sdr_prior_to_election_day as prior_election_day_sdr,
  a3a_total_registered_forms as total_reg_received,
  a3b_new_valid as total_valid_reg,
  a3c_new_pre_reg as pre_reg,
  a3e_invalid as invalid_reg,
  a4a_mail_total as mail_reg,
  a4b_in_person_total as in_person_reg,
  a4c_online_total as online_reg,
  a4d_dmv_total as dmv_reg,
  a4e_nvra_mandated_total as nvra_reg,
  a4f_disabilities_agency_total as disability_reg,
  a4g_armed_forces_total as armed_forces_reg,
  a4h_non_nvra_mandated_total as non_nvra_reg,
  a5a_mail_new_reg as new_mail_reg,
  a5b_in_person_new_reg as new_in_person_reg,
  a5c_online_new_reg as new_online_reg,
  a5d_dmv_new_reg as new_dmv_reg,
  a5e_nvra_mandated_new_reg as new_nvra_reg,
  a5f_disabilities_agency_new_reg as new_disability_reg,
  a5g_armed_forces_new_reg as new_armed_forces_reg,
  a5h_non_nvra_mandated_new_reg as new_non_nvra_reg,
  a8a_notifications_total as confirmation_notices_sent,
  a8b_notifications_received_confirming as confirmation_notices_received,
  a9a_removed_total as total_voters_removed,
  a9b_removed_moved as voters_removed_moved,
  a9c_removed_death as voters_removed_death,
  a9d_removed_felony as voters_removed_felony,
  a9e_removed_fail_response as voters_removed_fail_response,
  a9f_removed_mentally_incompetent as voters_removed_mentally_incompetent,
  a9g_removed_voter_request as voters_removed_voter_request
FROM `eavs-392800.eavs_2022.eavs_county_22_A_REG`

UNION ALL

-- 2024 Data
SELECT 
  fips,
  '2024' as election_year,
  state,
  county,
  state_abbr,
  county_name,
  NULL as election_year,
  state as state,
  county as county,
  state_name_abbreviation as state_abbr,
  county_name as county_name,
  a1a_total_reg as total_reg,
  a1b_total_active as total_active_reg,
  a1c_total_inactive as total_inactive_reg,
  a2a_total_sdr as total_sdr,
  a2b_election_day_sdr as election_day_sdr,
  a2c_sdr_prior_to_election_day as prior_election_day_sdr,
  a3a_total_reg_transactions as total_reg_received,
  a3b_new_valid as total_valid_reg,
  a3c_new_pre_reg as pre_reg,
  a3f_invalid as invalid_reg,
  a4a_mail_total as mail_reg,
  a4b_in_person_total as in_person_reg,
  a4c_online_total as online_reg,
  a4e_dmv_total as dmv_reg,
  a4f_nvra_mandated_total as nvra_reg,
  a4g_disabilities_agency_total as disability_reg,
  a4h_armed_forces_total as armed_forces_reg,
  a4i_non_nvra_mandated_total as non_nvra_reg,
  a5a_mail_new_reg as new_mail_reg,
  a5b_in_person_new_reg as new_in_person_reg,
  a5c_online_new_reg as new_online_reg,
  a5e_dmv_new_reg as new_dmv_reg,
  a5f_nvra_mandated_new_reg as new_nvra_reg,
  a5g_disabilities_agency_new_reg as new_disability_reg,
  a5h_armed_forces_new_reg as new_armed_forces_reg,
  a5i_non_nvra_mandated_new_reg as new_non_nvra_reg,
  a10a_notifications_total as confirmation_notices_sent,
  a10b_notifications_received_confirming_no_add_change as confirmation_notices_received,
  a12a_removed_total as total_voters_removed,
  a12b_removed_moved as voters_removed_moved,
  a12c_removed_death as voters_removed_death,
  a12d_removed_felony as voters_removed_felony,
  a12e_removed_fail_response as voters_removed_fail_response,
  a12f_removed_incompetent_to_vote as voters_removed_mentally_incompetent,
  a12g_removed_voter_request as voters_removed_voter_request
FROM `eavs-392800.eavs_2024.eavs_county_24_A_REG`